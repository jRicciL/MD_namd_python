<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tutorial</title>
    <link rel="stylesheet" href="https://bootswatch.com/4/journal/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="./prism.css">
    <script src="http://3Dmol.csb.pitt.edu/build/3Dmol-min.js"></script>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
<div class="container">
    <h1 class="title">Molecular dynamics with namd</h1>
    <section>
        <h2>Introduction</h2>
        <p>Introducción y hablar sobre la proteína y dar las referencias al manual de amber, namd y al papaer.</p>
    </section>
    
    <section>
        
    <h2>Preparación del sistema</h2>
    <p></p>

    <div style="height: 400px; width: 100%; position: relative;" class='viewer_3Dmoljs justify-content-center border' data-pdb='1L2Y' 
    data-backgroundcolor='0xffffff' 
    data-style1='cartoon:color=spectrum' 
    data-surface1='opacity:.7;color:white'>
    </div>  


    <pre><code class="language-tcl">
# Script para crear el archivo de topologia .psf
package require psfgen
topology ../0-inputs/top_all27_prot_lipid.inp
pdbalias residue HIS HSE
pdbalias atom ILE CD1 CD
segment T {pdb TC5b_input.pdb}
coordpdb TC5b_input.pdb T
guesscoord
writepdb tc5b.pdb
writepsf tc5b.psf
</code></pre>

    <p>Este archivo contiene la siguiente información:</p>

    <ol class="list">
        <li>Carmagos la librería <code>psfgen</code> a través de VMD.</li>
        <li>Llamámos al archivo de topología <code>top_all27_prot_lipid.inp</code>, que se encuentra en el directorio <code>0-inputs</code>. Si el archivo está en otro directorio, asegúrate de indicar el <i>path</i> en el script.</li>
        <li>
        Renombramos todos los residuos <code>HIS</code> a <code>HSE</code> para que concuerde con la nomenclatura del archivo de topología.
        </li>
        <li>
        Renombramos todos los átomos <code>CD1</code> (carbonos delta) de los residuos <code>ILE</code> como <code>CD</code>.
        </li>
        <li>Se crea un segmento <b>T</b> con los átomos del archivo <code>TC5b_input.pdb</code>. También se añaden hidrógenos.</li>
        <li>Se leen las coordenadas del archivo <code>TC5b_input.pdb</code> y se asignan a los átomos del segmento T.</li>
        <li>Las coordenadas de los átomos del segmento T que no se hayan podido leer del archivo pdb (hidródenos, por ejemplo) son asignadas de acuerdo a su definiciín en el archivo de topología.</li>
        <li>Se guarda en el directorio actual un nuevo archivo <strong>pdb</strong>, <code>tc5b.pdb</code>, correspondiente al segmento <strong>T</strong>.</li>
        <li>Se guarda en el directorio actual un archivo <strong><i>.psf</i></strong> (<i>protein structure file</i>); <code>tc5b.psf</code>, con la información estructural de la proteína.</li>
    </ol>

    <p>A continuación, vamos a correr el <i>script</i> desde la terminal a través del <b>VMD</b> en modo texto. Para ello, ejecuta el siguiente comando en una terminal.</p>

    <pre><code class="language-shell">
vmd -dispdev text -e gen_psf.tcl
    </code></pre>

    <pre  class="border border-dark rounded container"><code>
...
psfgen) Info: writing pdb file tc5b.pdb
psfgen) Info: Atoms with guessed coordinates will have occupancy of 0.0.
psfgen) Info: pdb file complete.
psfgen) Info: writing psf file tc5b.psf
psfgen) total of 304 atoms
psfgen) total of 310 bonds
psfgen) total of 565 angles
psfgen) total of 843 dihedrals
psfgen) total of 49 impropers
psfgen) total of 0 explicit exclusions
psfgen) total of 18 cross-terms
psfgen) Info: psf file complete.
            
    </code></pre>

    <p>Como resultado VMD ejecuatrá <code>psfgen</code> con los comandos indicados. Mientras se construye tu sistema, la terminal irá arrojando una serie de mensajes. Si todo salió bien verás que dos nuevos archivos han sido creados en tu carpeta  de trabajo:<code>tc5b.psf</code> y <code>tc5b.pdb</code>. </p>



<!--Iamgen del mapa de flujo con los archivos-->
<img src="" alt="">
                    
    </section> <!-- Fin sección 2-->

    <section>
        <h2>Solvatación del sistema</h2>
        <p>Ahora procederemos a solvatar a la proteína, es decir, ponerla en una caja de agua que permita aproximar al sistema a un ambiente fisiolǵico.</p>
        <p>Ahora trbajaremos en un nuevo directorio; . Si has clonado el repositorio de Github encontrarás en él el un pequeño <i>script</i> llamado <code>solvate_wat_box.tcl</code> el cual puedes usar directamente para solvatar tu sistema siempre y cuando existan los archivos de entrada necesarios.</p>
        <p>Sin embargo, en este tutorial iremos paso a paso trabajando con los comandos del archivo <code>solvate_wat_box.tcl</code>, pero directamente desde la consola <strong><i>Tk/Tcl</i></strong> de <strong>VMD</strong>.</p>

        <ol class="list-group list-group-flush">
                <li class="list-group-item">Crea una nueva carpeta llamada <code>2-solvatar_wt</code> y copia en ella los archivos <code>tc5b.psf</code> y  <code>tc5b.pdb</code>.</li>
                <li class="list-group-item">
                    Abre VMD desde este nuevo directorio y después ve a la pestaña <code>Extensions &#8674 Tk Console</code>. Esto abrirá una ventana donde procederemos a escribir los siguientes comandos:
                </li>
                <li class="list-group-item"> Ejecuta: 
                    <code class="inline-code"><span class="kw">set</span> molname "tc5b"</code> <br> 
                    Esto generará una variable llamada <code>molname</code> con el texto <code>"tc5b"</code>, que corresponde al nombre de nuestra proteína.
                </li>
                <li class="list-group-item">
                    <code class="inline-code"><span class="kw">package</span> require solvate</code> <br>
                    <code class="inline-code"><span class="kw2">solvate</span> <span class="sm">${molname}</span>.psf <span class="sm">${molname}</span>.pdb -t 15 -o <span class="fl"><span class="sm">${molname}</span>_temp</span></code> <br> 
                    Solvatará la proteína en una caja de agua con un <i>padding</i> de 15 A.</li>
                <li class="list-group-item">Tras ejecutar la línea anterior, verás que se han creado dos nuevos archivos en tu carpeta de trabajo. Puedes visualizarlos tecleando en la Consola Tk lo siguiente:
                    <br>
                    <code class="inline-code"><span class="kw2">mol</span> new <span class="sm">${molname}</span>_temp.psf </code> <br>
                    <code class="inline-code"><span class="kw2">mol</span> addfile <span class="sm">${molname}</span>_temp.pdb </code> <br>
                    Finalmente, si has visualizado la molécula, puedes "cerrarla" de la sesión de vmd con el siguiente comando: <br>
                    <code class="inline-code"><span class="kw2">mol</span> delete top </code> <br>

                </li>
        </ol>
    </section>
    <section>
        <h2>Neutralización del sistema</h2>
    </section>

</div>

<script src="prism.js"></script>

</body>
</html>